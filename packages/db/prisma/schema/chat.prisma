enum ChatRole {
  system
  user
  assistant
}

model ChatSession {
  id        String   @id @default(cuid())
  agentKey  String
  title     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  messages ChatMessage[]

  @@index([userId, agentKey])
  @@map("chat_session")
}

model ChatMessage {
  id        String   @id @default(cuid())
  role      ChatRole
  content   String
  createdAt DateTime @default(now())

  sessionId String
  session   ChatSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([sessionId, createdAt])
  @@map("chat_message")
}
